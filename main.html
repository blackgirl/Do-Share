<!doctype html>
<link rel="icon" href="icon128.png" />
<script>
function d(){
  document.getElementById("timeParsed").innerHTML = new Date(document.getElementById('time').value).toString();
}
function val(name) {
  var $ = document.getElementById(name).value;
  return ($ ? $ : undefined);
}
function post(){
  var post = {
    'content': val('content'),
    'share_id': val('share_id'),
    'timeStamp': new Date(val('time')).getTime()
  }
  var link = val('link');
  if (link) {
    post.link = link;
  }
  chrome.extension.sendRequest({'type': 'post', 'post': post, 'time': post.timeStamp}, function(){});
}

function renderPost(post) {
  var p = document.createElement('p');
  p.innerHTML = new Date(post.timeStamp).toString() + '<br >' + post.content;
  return p;
}

function drafts() {
  chrome.extension.sendRequest({'type': 'fetchAll'}, function(result) {
    var postsDiv = document.getElementById('posts');
    result.posts.forEach(function(post) {
      console.log(post);
      postsDiv.appendChild(renderPost(post));
    });
  });
}
</script>
<textarea id='content'>Content</textarea>
<input id='time' /><button onclick='d()'>Parse</button>
<p id='timeParsed'></p>
<input id='share_id' placeholder="shared id" />
<input id='link' placeholder="link" />
<div id="posts">
</div>
